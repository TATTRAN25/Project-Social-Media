{% extends 'base.html' %}

{% load static %}
<link rel="stylesheet" href="{% static 'assets/css/style_post_detail.css' %}">

{% block body_block %}
<div class="container post-detail-container">
    <h1 class="post-title">Tiêu đề: {{ post.title }}</h1>
    {% if post.image %}
        <img src="{{ post.image.url }}" alt="Hình ảnh bài viết" class="post-image">
    {% else %}
        <p class="no-image">Không có hình ảnh</p>
    {% endif %}
    <p class="post-content">Nội dung: {{ post.content }}</p>
    <p class="post-author"><strong>Tác giả:</strong> {{ post.author.username }}</p>
    
    <div class="post-actions">
        {% if request.user == post.author %}
            <form method="post" action="{% url 'SocialMedia:post_detail' post.id %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger post-delete-btn">Xóa Bài Viết</button>
            </form>
            <a href="{% url 'SocialMedia:manage_post_edit' post.id %}" class="btn btn-secondary post-edit-btn">Chỉnh sửa Bài Viết</a>
        {% endif %}
        <a href="{% url 'SocialMedia:user_profile' post.author.userprofileinfo.id %}" class="btn btn-primary post-back-btn">Quay lại Trang</a>
    </div>

    <!-- Phần bình luận -->
    <div class="comments-section">
        <h3>Bình luận</h3>
        {% if comments %}
            <ul class="comments-list">
                {% for comment in comments %}
                    <li class="comment">
                        <strong>{{ comment.author.username }}</strong> {{ comment.created_at|timesince}} ago:
                        <p>{{ comment.content }}</p>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Chưa có bình luận nào.</p>
        {% endif %}

        <!-- Form bình luận -->
        <h4>Thêm Bình Luận</h4>
        <form method="POST">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">Gửi Bình Luận</button>
        </form>
    </div>

</div>
{% endblock %}